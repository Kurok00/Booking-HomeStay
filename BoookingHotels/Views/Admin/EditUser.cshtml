@model BoookingHotels.Models.User
@{
    ViewData["Title"] = "Edit User";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="container py-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="fw-bold text-primary"><i class="bi bi-pencil-square"></i> Edit User</h2>
        <a asp-action="Users" class="btn btn-secondary shadow-sm">
            <i class="bi bi-arrow-left"></i> Back
        </a>
    </div>

    <div class="card shadow-sm rounded-4 border-0">
        <div class="card-body p-4">
            <form asp-action="EditUser" method="post">
                <input type="hidden" asp-for="UserId" />

                <div class="row g-3">
                    <div class="col-md-6">
                        <label class="form-label fw-semibold">User Name</label>
                        <input asp-for="UserName" class="form-control shadow-sm" />
                    </div>
                    <div class="col-md-6">
                        <label class="form-label fw-semibold">Email</label>
                        <input asp-for="Email" class="form-control shadow-sm" readonly />
                    </div>
                    <div class="col-md-6">
                        <label class="form-label fw-semibold">Phone</label>
                        <input asp-for="Phone" class="form-control shadow-sm" />
                    </div>
                    <div class="col-md-6">
                        <label class="form-label fw-semibold">Full Name</label>
                        <input asp-for="FullName" class="form-control shadow-sm" />
                    </div>
                    <div class="col-md-6">
                        <label class="form-label fw-semibold">Status</label>
                        <select asp-for="Status" class="form-select shadow-sm">
                            <option value="true">Active</option>
                            <option value="false">Inactive</option>
                        </select>
                    </div>
                </div>

                <div class="mt-3">
                    <label class="form-label fw-semibold">User Roles <span class="text-danger">*</span></label>
                    <div class="border rounded p-3 bg-light">
                        @if (ViewBag.Roles != null)
                        {
                            var userRoles = ViewBag.UserRoles as List<int>;
                            @foreach (var role in ViewBag.Roles)
                            {
                                var isChecked = userRoles != null && userRoles.Contains(role.RoleId);
                                <div class="form-check">
                                    <input class="form-check-input" 
                                           type="checkbox" 
                                           name="selectedRoles" 
                                           value="@role.RoleId" 
                                           id="role_@role.RoleId"
                                           @(isChecked ? "checked" : "")>
                                    <label class="form-check-label" for="role_@role.RoleId">
                                        <strong>@role.RoleName</strong>
                                        @if (role.RoleName == "Admin")
                                        {
                                            <span class="badge bg-danger ms-2">Full Access</span>
                                        }
                                        else if (role.RoleName == "Host")
                                        {
                                            <span class="badge bg-primary ms-2">Manage Hotels</span>
                                        }
                                        else if (role.RoleName == "User")
                                        {
                                            <span class="badge bg-success ms-2">Customer</span>
                                        }
                                    </label>
                                </div>
                            }
                        }
                    </div>
                    <small class="form-text text-muted">Select at least one role for the user</small>
                </div>

                <div class="d-flex justify-content-end mt-4">
                    <button type="submit" class="btn btn-primary fw-bold px-4 shadow-sm">
                        <i class="bi bi-save"></i> Update
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
